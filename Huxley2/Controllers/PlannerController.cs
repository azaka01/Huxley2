using Microsoft.AspNetCore.Mvc;using Microsoft.Extensions.Logging;using System.Diagnostics;using System;using Huxley2.Interfaces;using System.Threading.Tasks;using ServiceReference;
using Microsoft.AspNetCore.Http;

// For more information on enabling Web API for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860

namespace Huxley2.Controllers{    [Route("api/[controller]")]    [ApiController]    public class PlannerController : ControllerBase    {        private readonly ILogger<PlannerController> _logger;        private readonly IJourneyPlannerService _journeyPlannerService;        public PlannerController(            ILogger<PlannerController> logger,            IJourneyPlannerService journeyPlannerService)        {            _logger = logger;            _journeyPlannerService = journeyPlannerService;        }        // GET api/<PlannerController>/5        [HttpGet("{id}")]
        [ProducesResponseType(typeof(ReturnResponseType), StatusCodes.Status200OK)]        [ProducesResponseType(typeof(RealtimeJourneyPlanResponse), StatusCodes.Status200OK)]        [ProducesDefaultResponseType]
        public async Task<ReturnResponseType> GetAsync(int id)        {            _logger.LogInformation($"Getting planner for query: {id}");            try            {                var clock = Stopwatch.StartNew();                var journeyDetails = await _journeyPlannerService.GetJourneyDetailsAsync();             //   _logger.LogInformation("OJP API response is ", journeyDetails.response.ToString());                clock.Stop();                _logger.LogInformation("OJP API time {ElapsedMilliseconds:#,#}ms",                    clock.ElapsedMilliseconds);                return journeyDetails;            }            catch (Exception e)            {                _logger.LogError(e, "JourneyPlanner request call failed");                throw;            }        }    }}